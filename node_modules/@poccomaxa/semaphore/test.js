var Semaphore = require('./index');
var semaphore = new Semaphore(2);

function expensive_operation(callback) {
    setTimeout(callback, 1000);
}

function fn() {
    semaphore.enter(function () {
        expensive_operation(function () {
            console.log(Date.now());
            semaphore.leave();
        });
    });
}

fn();
fn();
fn();
fn();